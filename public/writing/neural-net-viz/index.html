 
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Visually Representing *What* Neural Networks Learn</title>
    
    <link rel="stylesheet" href="/darkearth-syntax.css" />
    <link rel="stylesheet" href="/style.css" />
    
  </head>
  <body class="min-h-screen flex flex-col justify-between bg-background text-primary p-6 dark" >
    <div class="font-mono w-full max-w-prose mx-auto flex-grow prose prose-a:no-underline leading-relaxed link-color">
    
<header>
  <nav class="flex space-x-5">
    <a href="/" class="no-underline">home</a>
    <a href="/projects" class="no-underline">projects</a>
    <a href="/writing" class="no-underline">writing</a>
  </nav>
</header>

    
<article>
  <main>
    <h2>Visually Representing *What* Neural Networks Learn</h2>
    <ul class="list-none pl-0">
      
      <li>
        <time datetime="2024-05-13">May 13, 2024</time>
      </li>
      
      <li>
        <span class="read-time"
          >7 min read</span
        >
      </li>
      
    </ul>
    <h3>Introduction</h3>
<p>Recently, I just finished a semester-long project in which a colleague and I investigated how neural networks learn using visualizations. As a computer and data scientist, this topic has fascinated me for a while. We spend so much time constructing and refining neural networks, but very little time actually trying to understand how they work behind the scenes.</p>
<h3>Background</h3>
<p>Neural networks are inherently black-box models, meaning data goes in one side, and results come out the other. This is unfortunate, as it means that neither the developer nor the end user has any idea what is actually taking place within the network. This results in outputs that are often uninterpretable and can call into question whether or not the results are even trustworthy.</p>
<p>This is a major problem, and it is only getting worse as we grow increasingly reliant on AI models in every aspect of our lives. It grows even worse when we take into account the fact that our models are becoming bigger and more complex, with the latest fascination being large language models (LLMs).</p>
<p>Unfortunately, there is no simple solution to this issue, and even beginning to look into the learning process within a network requires an engaged effort from the creator. Our project began an investigation into methods through which neural networks could be visualized, with the goal of adding transparency to the model training process and turning AI into XAI (Explainable AI).</p>
<h3>Project Scope</h3>
<p>As this was a semester project, the scope had to be fairly limited. Most notably, we did not set out to try and set up a modular application in which any network could be visualized and instead focused on a few chosen datasets (to establish a prototype of sorts).</p>
<p>We also only looked at classification networks, as regression networks are another animal entirely and would likely suffer from even more extreme interpretability issues than classifiers</p>
<h3>Design Objectives and Decisions</h3>
<p>Our approach to visualizing the learning process consisted of visualizing network weights (for image classification tasks) through the use of animated image plots. To create these plots, we plotted each weight in a layer as a single pixel in the image, with the color representing the value of that weight. Each image is made up of all the weights for a single neuron in a layer, and the images were arranged in a grid with all the images for that layer. To show how these weights evolve over the course of network training, we stitched the grid plots together into an animation.</p>
<p>The other main component of our visualization of the learning process was visualizing network decision boundaries over time. To do this, we created a scatterplot of the data points and overlaid it on top of a contour plot representing the decision boundary of the network. In the scatterplot, the color of a point represents the class it is a part of. The colors of the contours are a bit harder to interpret (an area for improvement), but the dark red regions represent the actual decision boundary, and the network becomes more uncertain (represented as the color getting lighter, then changing to blue) as it gets farther away from the dark red region. Again, we wanted to show how the decision boundary changes during the training process, so we stitched the contour plots together into an animation.</p>
<h3>Tools Used</h3>
<p>To train our network and store the weights, we used Python with the PyTorch and SciKit-Learn libraries.<br>
The weight and boundary visualizations were created in Python and animated using ffmpeg.<br>
The exploratory PCA and <em>t</em>-SNE plots were created with R and ggplot, with the 3-dimensional plots being made with ggplotly.<br>
The overarching website was created using R-markdown, knit (compiled) to a couple of html pages, and then hosted using GitHub pages.</p>
<h3>Results</h3>
<p>The website for this project can be found at <a href="https://aanish-pradhan.github.io/CS-5764-Project/">here</a><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. The source code for our code can also be found below<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>.</p>
<h4>Visualizing Decision Boundaries</h4>
<p>The decision boundary contour plot animations demonstrate how a neural network's decision boundary evolves and bisects the dataset it is trained on. Points represent the dataset, and the contoured background shows the decision boundary, with colors indicating the distance from the boundary. For example, using the Moons dataset, a highly nonlinear boundary is needed for correct classification.</p>
<p><img src="/images/nnviz-db-e1.png" alt=""></p>
<ul>
<li>Decision Boundary: Epoch 1</li>
</ul>
<p>The initial state of the decision boundary is completely random at the start of training.</p>
<p><img src="/images/nnviz-db-e20.png" alt=""></p>
<ul>
<li>Decision Boundary: Epoch 20</li>
</ul>
<p>After 20 epochs, the boundary has shaped to separate many of the points from each cluster, but it still misclassifies many entries at this point.</p>
<p><img src="/images/nnviz-db-e100.png" alt=""></p>
<ul>
<li>Decision Boundary: Epoch 100</li>
</ul>
<p>After 100 epochs, we can see that the decision boundary perfectly separates the two classes.</p>
<h4>Dimensionality Reduction for High-Dimensional Datasets</h4>
<p>The exploratory analysis page includes plots using Principal Component Analysis (PCA) and <em>t</em>-Distributed Stochastic Neighbor Embedding (<em>t</em>-SNE) to illustrate class distributions in the MNIST dataset. PCA plots show blurred boundaries between classes, while <em>t</em>-SNE plots reveal distinct clusters and greater sensitivity to in-group differences. For both PCA and <em>t</em>-SNE we included a biplot, de<br>
nsity biplot, and 3D plot of the class embeddings.</p>
<p><img src="/images/nnviz-pca-biplots.png" alt=""></p>
<ul>
<li>PCA Biplot and Density Biplot</li>
</ul>
<p><img src="/images/nnviz-tsne-biplots.png" alt=""></p>
<ul>
<li><em>t</em>-SNE Biplot and Density Biplot</li>
</ul>
<p>Between the two dimensionality reduction algorithms, <em>t</em>-SNE was better in this case at visually separating the classes from the dataset. We found the density biplot to be the most effective at visually communicating the distribution of the different data classes.</p>
<h4>Visualizing Neuron Weights</h4>
<p>Weight visualization animations show how neuron weights evolve during training for high-dimensional datasets like MNIST. Initially random, many of these weights gradually form (somewhat) recognizable patterns.</p>
<p><img src="/images/nnviz-wv-e1.png" alt=""></p>
<ul>
<li>Neuron Weights: Epoch 1</li>
</ul>
<p><img src="/images/nnviz-wv-e20.png" alt=""></p>
<ul>
<li>Neuron Weights: Epoch 20</li>
</ul>
<p>After 20 epochs, we can see a number of patterns that resemble entire numbers or parts of them.</p>
<p><img src="/images/nnviz-wv-e100.png" alt=""></p>
<ul>
<li>Neuron Weights: Epoch 100</li>
</ul>
<p>After 100 epochs, most weights became very muddled, still holding the previous patterns but in more muddy state. This may seem counterintuitive as the network appears (from the eyes of a human) to have lost the original patterns, but the network was performing noticeably better in classification tasks at the 100 epoch mark.</p>
<h3>Limitations</h3>
<p>A significant challenge in this project was visualizing high-dimensional data, decision boundaries, and weights. For instance, it wasn't possible to plot the decision boundary for the MNIST image classification dataset in a contour plot due to its high dimensionality. However, by using weight visualizations, it was possible to represent individual components of the decision boundary, offering insights into the network's behavior when trained on this dataset.<br>
To address the dimensionality issue, PCA could be used to shrink the decision boundary into two or three dimensions, making visualization possible through contour plots. While this approach might produce messy or unclear results, it warrants further exploration and could yield intriguing findings.</p>
<p>Another inherent limitation is that for large datasets with many unique output classes, weight visualizations often become unintelligible due to the wide range of possible weight values. This issue is more complex than the dimensionality problem but represents another potential area for future research.</p>
<h3>Closing Thoughts</h3>
<p>This project underscored the complexity of visualizing neural networks, especially when dealing with high-dimensional data. Despite the challenges, our efforts provided valuable insights into the learning processes of neural networks. By visualizing decision boundaries and neuron weights, we were able to peek into the black-box nature of these models and understand their behavior better.</p>
<p>The techniques we used, like PCA and <em>t</em>-SNE for dimensionality reduction, and animated weight visualizations, showed promise in making neural networks more interpretable. However, there are still significant limitations, especially in visualizing high-dimensional decision boundaries and weights for large datasets with many classes.</p>
<p>Future research could explore more advanced dimensionality reduction techniques or develop new methods for visualizing neural networks. Our project is a step towards making AI models more transparent and trustworthy, contributing to the broader goal of Explainable AI (XAI). By continuing to innovate and experiment, we can hope to further demystify these powerful yet complex models.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://aanish-pradhan.github.io/CS-5764-Project/">Project Site</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://github.com/aanish-pradhan/CS-5764-Project">Source Code</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
 
<div id="comments"></div>
<script src="/bluesky-comments.js"></script>
<script>
  
  BlueskyComments("#comments", { author: "pdewey.com" });
  
</script>

  </main>
</article>

    
<footer>
  
</footer>

    </div>
  </body>
</html>

